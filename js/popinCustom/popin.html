<!doctype html>
<html>
<!--[if lt IE 7]> <html class="no-js ie lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>	<html class="no-js ie lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>	<html class="no-js ie lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>	<html class="no-js ie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>popin</title>
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="viewport" content="width=device-width">
	<link rel="stylesheet" href="public/css/reset.css">	
	<link rel="stylesheet" href="public/css/style.css">
</head>
<body>

	<div id="popin1" class="popin" style="display: none;">
		<div class="title">IMAH POPIN</div>
		<p>
			Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatum, unde, nesciunt, fugit voluptas praesentium suscipit earum dolorem est asperiores iure accusamus omnis aut quas itaque cumque reprehenderit accusantium tempore incidunt?
		</p>
	</div>
<a href="#" data-target="popin1" class="showPopin">openPopin</a>
	<style>
		html,
		body{width: 100%; height: 100%; overflow: auto;}
		body{position: relative;}
		.contentPopin{text-align: center; z-index: 999999999999; width: 100%; height: 100%; position: fixed; top: 0; left: 0; background: #000; background: rgba(0,0,0,0.72);}
		.popin{display: inline-block; margin-top: 50px; width: 100%; max-width: 640px; height: 330px; background: #fff; text-align: left; padding-left: 20px; position: relative;}
		.popin .close{position: absolute; top: 5px; right: 5px;}
		#popin1 .title{margin: 50px 0; font-family: Helvetica, Arial; font-weight: bold; font-size: 32px; color: #2a333d;}
		#popin1 p{color: #808080; font-size: 12px; font-family: Arial; line-height: 14px; }
		#popin1 p a{color: #808080;}
		#popin1 p img{margin: 5px 0 0 8px;}
		#popin1 span.suiteSmall{cursor: pointer; background-position: 0 2px;}
	</style>

	<script type="text/javascript" src="public/js/libs/jquery-1.8.2.min.js"></script>
	<script>
		$(document).ready(function(){
			$(".popin")
					.css({"display":"none"})
					.wrap($("<div class='contentPopin' style='display:none;'></div>"));
			$(".popin").append("<button class='close'>close</button>")
			$(".showPopin").click(function(){
				var $this = $(this)
				openPopin($this);
			});
			function openPopin($this){
				var actionBefore = $this.attr("data-before")
				,	$target = $("#"+$this.attr("data-target"));

				if(eval(actionBefore) == false){// if the prefuntion fail, don' show the popin
					return;
				}

				$this.blur();
				$target.show()
					.closest(".contentPopin").show();
				posPopin($target);
			}
			function posPopin($target){
						console.log($target);
				if(typeof $target === "undefined" || typeof $target === "object"){
					$(".popin").each(function(){
						var $target = $(this);
						var	wh = $(window).height()
						,   ph = $target.outerHeight();
						if( wh > (ph+20) ){
							$target.css({"margin-top" : (wh-ph)/2})
						}else{
							$target.css({"margin-top" : 0})
						}
					});
				}else{
					var $target = $target;
					var	wh = $(window).height()
					,   ph = $target.outerHeight();
					if( wh > (ph+20) ){
						$target.css({"margin-top" : (wh-ph)/2})
					}else{
						$target.css({"margin-top" : 0})
					}
				}
			}posPopin();

			$("body").delegate(".popin","click", function(e){
				e.stopPropagation();
			});

			$("body").delegate(".contentPopin, .close", "click", function(){
				$(this)
				$(".popin").hide().closest('.contentPopin').hide();;
			});

			if(window.addEventListener){
				window.addEventListener('resize', posPopin, false);
			}else{
				window.attachEvent ('onresize', posPopin);
			}
		});
	</script>
</body>
</html>